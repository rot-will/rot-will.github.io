<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png"><link rel="icon" href="/img/avatar.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="rot_will"><meta name="keywords" content=""><meta property="og:type" content="website"><meta property="og:title" content="rot&#39;s Blog"><meta property="og:url" content="https://rot-will.github.io/page/2/index.html"><meta property="og:site_name" content="rot&#39;s Blog"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="rot_will"><meta name="twitter:card" content="summary_large_image"><title>rot&#39;s Blog</title><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="/css/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link id="csscustom_image-light" rel="stylesheet" href="/css/image.css"><link id="csscustom_image-dark" rel="stylesheet" href="/css/image-dark.css"><link id="csscustom_salient-light" rel="stylesheet" href="/css/salient.css"><link id="csscustom_salient-dark" rel="stylesheet" href="/css/salient-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"rot-will.github.io",root:"/",version:"1.9.2",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!0,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:100vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Rot-will</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="哈哈哈"></span></div></div><div class="scroll-down-bar"><i class="iconfont icon-arrowdown"></i></div></div></div></div></div></header><main><div class="container nopadding-x-md"><div id="board" style="margin-top:0"><div class="container"><div class="row"><div class="col-12 col-md-10 m-auto"><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/heap/IO%E7%BB%93%E6%9E%84%E4%BD%93%E5%88%86%E6%9E%90/" target="_self">IO结构体分析</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/heap/IO%E7%BB%93%E6%9E%84%E4%BD%93%E5%88%86%E6%9E%90/" target="_self"><div>Here&#39;s something encrypted, password is required to continue reading.</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-12-09 15:10" pubdate>2022-12-09</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/heap/" class="category-chain-item">heap</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/wp/NCTF2021-pwn/" target="_self">NCTF2021-pwn</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/wp/NCTF2021-pwn/" target="_self"><div>ezheap 在delete函数中存在UAF漏洞，可以多次释放同一个chunk，但如果chunk已经被释放，则无法修改chunk数据 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-11-30 10:17" pubdate>2022-11-30</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/wp/" class="category-chain-item">wp</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a> <a href="/tags/wp/">#wp</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/wp/2021%E9%87%91%E7%A0%96-pwn/" target="_self">2021金砖-pwn</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/wp/2021%E9%87%91%E7%A0%96-pwn/" target="_self"><div>pmagic1 123456789101112131415161718192021222324252627282930313233343536373839404142from pwn import *def pwn(p,gadget): libc&#x3D;ELF(&amp;#x27;.&#x2F;libc-2.23.so&amp;#x27;,checksec&#x3D;0) p.sendafter(&quot;name.\n&amp;</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-11-24 18:17" pubdate>2022-11-24</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/wp/" class="category-chain-item">wp</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a> <a href="/tags/wp/">#wp</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/heap/%E5%A0%86%E5%9F%BA%E7%A1%80/" target="_self">堆基础</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/heap/%E5%A0%86%E5%9F%BA%E7%A1%80/" target="_self"><div>Here&#39;s something encrypted, password is required to continue reading.</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-11-22 15:10" pubdate>2022-11-22</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/heap/" class="category-chain-item">heap</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/heap/%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E4%B8%80/" target="_self">攻击方法一</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/heap/%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E4%B8%80/" target="_self"><div>Here&#39;s something encrypted, password is required to continue reading.</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-11-22 15:10" pubdate>2022-11-22</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/heap/" class="category-chain-item">heap</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/heap/%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E4%BA%8C/" target="_self">攻击方法二</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/heap/%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E4%BA%8C/" target="_self"><div>Here&#39;s something encrypted, password is required to continue reading.</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-11-22 15:10" pubdate>2022-11-22</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/heap/" class="category-chain-item">heap</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/wp/%E7%AC%AC%E4%BA%94%E5%B1%8A%E6%B5%99%E6%B1%9F%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E9%A2%84%E8%B5%9B-pwn/" target="_self">第五届大学生浙江省网络安全大赛预赛-pwn</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/wp/%E7%AC%AC%E4%BA%94%E5%B1%8A%E6%B5%99%E6%B1%9F%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E9%A2%84%E8%B5%9B-pwn/" target="_self"><div>new_stack 后门函数会将我们输入的数据写入栈中，刚好最后8字节可以修改X29寄存器的值，而这个寄存器在程序中是用来临时储存函数第一个参数的寄存器，会用来修改X0寄存器，刚好在后门函数结束后会执行一次输入输出，这时可以通过修改got表控制程序流程 1234567891011121314151617181920212223242526272829303132&quot;&quot;&amp;quo</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-09-29 10:17" pubdate>2022-09-29</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/wp/" class="category-chain-item">wp</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a> <a href="/tags/wp/">#wp</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%A4%B4/" target="_self">文件格式头</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%A4%B4/" target="_self"><div>Mime Type（Content-Type） 文件扩展名 文件头 video&#x2F;3gpp 3gp 00 00 00 14 66 74 79 7000 00 00 14 66 74 79 7000 00 00 20 66 74 79 7000 00 00 20 66 74 79 70 video&#x2F;mp4 mp4 00 00 00 14 66 74 79 70 69 73 6f 6d</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-09-28 19:41" pubdate>2022-09-28</time></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/misc/">#misc</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/wp/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%9D%92%E5%B0%91%E5%B9%B4%E6%9D%AF%E9%A2%84%E8%B5%9B/" target="_self">第六届强网杯青少年杯</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/wp/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%9D%92%E5%B0%91%E5%B9%B4%E6%9D%AF%E9%A2%84%E8%B5%9B/" target="_self"><div>战队信息 战队名称：Rml 战队排名：5 web web1 CVE-2021-41773，payload直接打 misc misc1 base64解密后得到一张图片，但是每两个字节被换了位置 修复脚本 123456f&#x3D;open(&amp;#x27;a.png&amp;#x27;,&amp;#x27;rb&amp;#x27;)f1&#x3D;open(&amp;#x27;b.png&amp;#x27;,&amp;#x27;wb&amp;#x27;)data&#x3D;f.read</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-09-23 10:17" pubdate>2022-09-23</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/wp/" class="category-chain-item">wp</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/wp/">#wp</a></div></div></article></div><div class="row mx-auto index-card"><article class="col-12 col-md-12 mx-auto index-info"><h1 class="index-header"><a href="/page/wp/2022%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2-pwn/" target="_self">2022巅峰极客-pwn</a></h1><a class="index-excerpt index-excerpt__noimg" href="/page/wp/2022%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2-pwn/" target="_self"><div>Gift 程序中仅允许创建10个chunk，但在remove_gift函数中存在uaf，bargain函数可以用来修改chunk的fd，且可以输入负数让fd向大地址偏移，但只能修改低四字节，经过测试，靶机中libc版本为libc_2.27~libc_2.31，所以可以利用tcache bin attack，在free_hook的位置写入one_gadget函数，来获取shell，使用正常的</div></a><div class="index-btm post-metas"><div class="post-meta mr-3"><i class="iconfont icon-date"></i> <time datetime="2022-08-18 10:17" pubdate>2022-08-18</time></div><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/wp/" class="category-chain-item">wp</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ctf/">#ctf</a> <a href="/tags/pwn/">#pwn</a> <a href="/tags/wp/">#wp</a></div></div></article></div><nav aria-label="navigation"><span class="pagination" id="pagination"><a class="extend prev" rel="prev" href="/"><i class="iconfont icon-arrowleft"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#board">3</a><a class="extend next" rel="next" href="/page/3/#board"><i class="iconfont icon-arrowright"></i></a></span></nav></div></div></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="/js/nprogress.min.js"></script><link rel="stylesheet" href="/css/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/local-search.js"></script><script src="/js/custom.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>